:root{
  --bg:#0b0f14; --fg:#dde1e6; --muted:#7a869a; --card:#121821; --accent:#4da4ff; --chip:#1a2430;
  --line:#00000033;
  --fs:16px;
  --topbar-h:56px;
  /* 版心寬：不超過 900px，且永遠保留左右 12px 邊距（在小螢幕生效） */
  --container: clamp(320px, 100vw - 24px, 900px);
}
:root.light{ --bg:#fff; --fg:#1a1a1a; --muted:#666; --card:#f4f6f8; --accent:#0a84ff; --chip:#e8eef5; --line:#0000001f; }

*{box-sizing:border-box}
html,body{height:100%}
html,body{overflow-x:hidden; touch-action:manipulation; -webkit-text-size-adjust:100%;}
body{margin:0;background:var(--bg);color:var(--fg);font:var(--fs)/1.6 -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans TC','PingFang TC',sans-serif}
a{color:var(--accent);text-decoration:none}
*{-webkit-tap-highlight-color:transparent}

/* ---- Sticky Header ---- */
.topbar{
  position:sticky;top:0;left:0;right:0;width:100%;z-index:20;
  display:flex;justify-content:space-between;align-items:center;gap:10px;
  padding-top:10px;padding-bottom:10px;
  padding-left: calc((100vw - var(--container)) / 2);
  padding-right: calc((100vw - var(--container)) / 2);
  background:var(--card);border-bottom:1px solid var(--line)
}
.logo{margin:0;font-size:20px;flex:0 0 auto}
.top-actions{display:flex;gap:8px;align-items:center;flex:1 1 auto;min-width:0}
#themeToggle{padding:6px 10px;background:var(--chip);color:var(--fg);border:0;border-radius:8px}
.font-toggle{padding:6px 10px;background:var(--chip);border:0;border-radius:10px;color:var(--fg);min-width:36px}
#searchInput{padding:8px 10px;border-radius:8px;border:1px solid var(--line);background:transparent;color:var(--fg);width:50vw;max-width:420px;font-size:16px}

/* ---- Filters（含分隔線 & 置中） ---- */
.filters{
  position:sticky;top:var(--topbar-h);left:0;right:0;width:100%;z-index:19;
  display:flex;gap:10px;align-items:center;flex-wrap:wrap;background:var(--bg);border-bottom:1px solid var(--line);
  padding-top:10px;padding-bottom:10px;
  padding-left: calc((100vw - var(--container)) / 2);
  padding-right: calc((100vw - var(--container)) / 2);
}
select{padding:8px 10px;border-radius:8px;background:var(--chip);color:var(--fg);border:1px solid var(--line)}
.chips{display:flex;gap:6px;flex-wrap:wrap;max-width:100%;overflow:hidden}
.chip{padding:6px 10px;background:var(--chip);border-radius:999px;color:var(--muted);border:1px solid var(--line);cursor:pointer;white-space:nowrap}
.chip--active{color:#fff;border-color:var(--accent);box-shadow:0 0 0 1px var(--accent) inset}
.chip--more{opacity:.9}

/* ---- Cards 列表置中 ---- */
.cards{
  list-style:none;margin:0 auto;padding:12px;
  display:grid;grid-template-columns:1fr;gap:12px;
  max-width: var(--container);
}
.card{padding:14px;border-radius:14px;background:var(--card);border:1px solid var(--line)}
.card h3{margin:0 0 6px 0;font-size:18px}
.card .meta{font-size:12px;color:var(--muted);display:flex;gap:8px;flex-wrap:wrap;margin-bottom:6px}
.card .preview{color:var(--fg);opacity:.85;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}

.empty,.error{text-align:center;color:var(--muted);padding:30px}
.view{display:none}
.view--active{display:block}

/* ---- 內頁也對齊版心 ---- */
.note{max-width: var(--container); margin:0 auto; padding:14px}
.note .meta{font-size:12px;color:var(--muted);display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px}
.markdown img{max-width:100%;height:auto;border-radius:8px;display:block;margin:10px auto;cursor:zoom-in}
.markdown pre{background:#00000033;padding:10px;border-radius:8px;overflow:auto}
.pager{display:flex;justify-content:space-between;gap:10px;max-width: var(--container); margin:0 auto 20px}
.btn{display:inline-block;padding:8px 12px;background:var(--chip);border-radius:8px}
.back{display:inline-block;margin-bottom:8px}

/* ---- 書籤按鈕 ---- */
.fab{position:fixed;right:14px;bottom:18px;z-index:30;background:var(--accent);color:#fff;border:0;border-radius:50%;width:52px;height:52px;box-shadow:0 6px 16px rgba(0,0,0,.35);font-size:22px;line-height:52px;text-align:center}

/* ---- Lightbox ---- */
#lightbox{position:fixed;inset:0;background:rgba(0,0,0,.88);display:none;align-items:center;justify-content:center;z-index:1000}
#lightbox.open{display:flex}
#lightboxImg{max-width:95vw;max-height:90vh;border-radius:8px}
body.modal-open{overflow:hidden}

/* ---- iPhone（<=420px）微調 ---- */
@media (max-width: 420px){
  .logo{font-size:18px}
  #searchInput{width:48vw}
  .card{padding:12px;border-radius:12px}
  .card h3{font-size:17px}
}

/* ---- iOS Safe Area ---- */
@supports(padding: max(0px)) {
  .topbar, .filters {
    padding-left: max(calc((100vw - var(--container)) / 2), env(safe-area-inset-left));
    padding-right: max(calc((100vw - var(--container)) / 2), env(safe-area-inset-right));
  }
}
